function initializeUpload(b,g){b=$(b);var e=0,c=0;b.find("#big-knob input, #small-knob input").knob();var d=0,f=0;b.find("#drop a").click(function(){$(this).parent().find("input").click()});b.fileupload({dropZone:b,dataType:"json",sequentialUploads:!0,add:function(h,a){d==f&&(b.find("ul li").remove(),c=e=0);c+=a.files[0].size;a.i=d;d++;$('<li id="upload_'+a.i+'"><i class="fa fa-fw fa-cog fa-spin"></i>&ensp;'+a.files[0].name+"</li>").hide().appendTo("#upload ul").slideDown();a.submit()},progress:function(h,
a){var d=parseInt(a.loaded/a.total*100,10),f=0<c?parseInt((e+a.loaded)/c*100,10):100;b.find("#small-knob input").val(d).change();b.find("#big-knob input").val(f).change()},always:function(b,a){e+=a.total;f++},done:function(c,a){"undefined"!==typeof a.response().result.upload_error?b.find("#upload_"+a.i).addClass("fail").append(" ("+a.response().result.upload_error+")").find("i").attr("class","fa fa-fw fa-times"):(b.find("#upload_"+a.i).addClass("done").find("i").attr("class","fa fa-fw fa-check"),
g(a.response().result))},fail:function(c,a){"undefined"!==typeof a.response().jqXHR.responseText&&apiFatal(a.response().jqXHR.responseText);b.find("#upload_"+a.i).addClass("fail").append(" (Unknown error)").find("i").attr("class","fa fa-fw fa-times")}});$(document).on("drop dragover",function(b){b.preventDefault()})};