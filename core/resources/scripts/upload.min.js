function initializeUpload(e,b){e=$(e);var g=0,c=0;e.find("#big-knob input, #small-knob input").knob();var f=0;var a=0;e.find("#drop a").click(function(){$(this).parent().find("input").click()});e.fileupload({dropZone:e,dataType:"json",sequentialUploads:true,add:function(j,i){if(f==a){e.find("ul li").remove();g=0;c=0}c+=i.files[0].size;i.i=f;f++;$('<li id="upload_'+i.i+'"><span></span>&ensp;'+i.files[0].name+"</li>").hide().appendTo("#upload ul").slideDown();var h=i.submit()},progress:function(k,j){var h=parseInt(j.loaded/j.total*100,10);var i=(c>0?parseInt((g+j.loaded)/c*100,10):100);e.find("#small-knob input").val(h).change();e.find("#big-knob input").val(i).change()},always:function(i,h){g+=h.total;a++},done:function(i,h){if(typeof h.response().result.upload_error!=="undefined"){e.find("#upload_"+h.i).addClass("fail").append(" ("+h.response().result.upload_error+")")}else{e.find("#upload_"+h.i).addClass("done");b(h.response().result)}},fail:function(i,h){if(typeof h.response().jqXHR.responseText!=="undefined"){apiError(h.response().jqXHR.responseText)}e.find("#upload_"+h.i).addClass("fail").append(" (Unknown error)")}});$(document).on("drop dragover",function(h){h.preventDefault()});function d(h){if(typeof h!=="number"){return""}if(h>=1000000000){return(h/1000000000).toFixed(2)+" GB"}if(h>=1000000){return(h/1000000).toFixed(2)+" MB"}return(h/1000).toFixed(2)+" KB"}};