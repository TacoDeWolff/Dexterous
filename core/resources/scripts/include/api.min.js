function api(a,d,b,c){a?$.ajax({type:null==d?"GET":"POST",url:a,data:d,dataType:"json",success:function(a){"undefined"!==typeof a.error?"undefined"!==typeof c&&c&&!1===c(a)||apiFatal(a.error.join("<br>")):"undefined"!==typeof b&&b&&(applyTooltips(),b(a))},error:function(a){"undefined"!==typeof c&&c&&!1===c(a)||("undefined"!==typeof a.responseJSON&&"undefined"!==typeof a.responseJSON.error?apiFatal(a.responseJSON.error.join("<br>")):"undefined"!==typeof a.responseText?apiFatal(a.responseText):"undefined"!==
typeof a.statusText?apiFatal(a.statusText):apiFatal(a))}}):apiFatal("no API URL set")}function apiFatal(a){$.fancybox.open({content:a,closeBtn:!1,beforeShow:function(){this.skin.css({background:"#F2DEDE",color:"#B94A48",border:"solid 1px #EED3D7"})},overlay:{closeClick:!0,locked:!1}})}function apiStatusClear(){$("#api_status div").stop(!0).hide()}
function apiStatusWorking(a){apiStatusClear();$("#api_status div.working").delay(800).fadeIn("fast");"undefined"!==typeof a&&$("#api_status div.working span").delay(800).html(a).find("span[data-time]").attr("data-time",(new Date).getTime())}function apiStatusSuccess(a){apiStatusClear();$("#api_status div.success").fadeIn("fast");"undefined"!==typeof a&&$("#api_status div.success span").html(a).find("span[data-time]").attr("data-time",(new Date).getTime())}
function apiStatusError(a){apiStatusClear();$("#api_status div.error").fadeIn("fast");"undefined"!==typeof a&&$("#api_status div.error span").html(a).find("span[data-time]").attr("data-time",(new Date).getTime())}
function apiStatusTime(){$("span[data-time]").each(function(){var a=$(this),d=parseInt(a.attr("data-time"));if(!isNaN(d)){var b=Math.round(((new Date).getTime()-d)/1E3),d=new Date(d),c;c=10>b?"":30>b?" seconds ago":60>b?" half a minute ago":120>b?" 1 minute ago":600>b?" "+Math.round(b/60)+" minutes ago":" "+d.getHours()+":"+d.getMinutes();a.text()!==c&&a.fadeOut(function(){a.text(c)}).fadeIn()}})}$(function(){setInterval(apiStatusTime,5E3);apiStatusTime()});